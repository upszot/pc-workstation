---
- debug:
    msg: "---- Realizando Configuraciones genericas  ----"


#para la pc de Brisi agregar al grub
#GRUB_CMDLINE_LINUX_DEFAULT="pci=nocrs quiet"
#"product_version": "IdeaPad 3 15IIL05"
#"system_vendor": "LENOVO",


- name: "Realiza configuraciones genericas"
  include: fedora/004_config_genericas_fedora.yml
  when: ansible_facts['distribution'] == "Fedora"
  tags:
    - config_genericos

- name: "Realiza configuraciones genericas"
  include: ubuntu/004_config_genericas_ubuntu.yml
  when: ansible_facts['distribution'] == "Ubuntu"
  tags:
    - config_genericos

- name: "add NOPASSWD in sudores for group {{ GROUP_ADMIN }}"
  become: yes
  lineinfile:
    path: /etc/sudoers
    state: present
    regexp: '^%{{ GROUP_ADMIN }}'
    line: '%{{ GROUP_ADMIN }} ALL=(ALL) NOPASSWD: ALL'
    validate: 'visudo -cf %s'

- name: "Upload alias generales"
  become: yes
  copy:
    src: "{{ item }}"
    dest: /etc/profile.d/
    owner: root
    group: root
    #mode: 0755
  with_items:
    - 00-aliases.sh

- name: Disable firewalld or iptable
  become: yes
  ansible.builtin.service:
    name: "{{ item}}"
    enabled: no
    state: stopped
  with_items:
    - iptables
    - firewalld
  ignore_errors: yes


#--------- Obtencion del Home del usuario remoto ------#
# - name: get ansible_user home directory
#   become: yes
#   shell: "getent passwd {{ ansible_user }}  | awk -F: '{ print $6 }'"
#   changed_when: false
#   register: user_home

# - name: Set HOME
#   set_fact:
#     HOME: "{{ HOME.stdout }}"
#-------------------------------------------------------#
